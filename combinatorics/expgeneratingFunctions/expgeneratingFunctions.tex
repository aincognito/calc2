\documentclass[handout]{ximera}

\input{../preamble}

\pgfplotsset{compat=1.13}

\outcome{Utilize exponential generating functions}

\title{3.3 Exponential Generating Functions}

\begin{document}



\begin{abstract}
We utilize exponential generating functions
\end{abstract}

\maketitle

Recall the problem of finding the number of permutations of the letters in the word MISSISSIPPI. The answer was $\dis \frac{11!}{4!4!2!1!}$.
Let's modify the question slightly.  Find the number of permutations of 9 of the letters in the word MISSISSIPPI. 
The answer is the sum over all combinations of 9 of the letters of the number of permutations of each combination. 
In other words, we must first select 9 of the 11 letters, then we must count the number of permutations of these 9 letters.  
After doing this for every possible selection of 9 of the 11 letters, we sum these answers.
There are 9 different combinations of 9 of the 11 letters:\\
SSISSIPPI, ISISSIPPI, ISSISSIPI, MSSSSIPPI, MSISSIPPI, MSSISSIPI, MIISSIPPI, MISISSIPI, and MISSISSII.\\
Thus the total number of ways to permute 9 of the 11 letters in the word MISSISSIPPI is
\[
\frac{9!}{4!3!2!} + \frac{9!}{4!3!2!} + \frac{9!}{4!4!1!} + \frac{9!}{4!2!2!1!} + \frac{9!}{3!3!2!1!} 
\]
\[
+ \frac{9!}{4!3!1!1!} + \frac{9!}{4!2!2!1!} + \frac{9!}{4!3!1!1!} + \frac{9!}{4!4!1!}
\]
 
We would like to see this answer a coefficient in some generating function.
For the letter M, consider the function $f_M(x) = 1+x$. For the letter I, consider $f_I(x) = 1 + x + \frac{x^2}{2!} + \frac{x^3}{3!} + \frac{x^4}{4!}$.
For the letter S, consider $f_S(x) = 1 + x + \frac{x^2}{2!} + \frac{x^3}{3!} + \frac{x^4}{4!}$,
and for the letter P, consider $f_I(x) = 1 + x + \frac{x^2}{2!}$.
The product of these functions is
\[
f(x) = \left(1+x\right)\left(1+x+\frac{x^2}{2!} + \frac{x^3}{3!} + \frac{x^4}{4!}\right)\left(1+x+\frac{x^2}{2!} + \frac{x^3}{3!} + \frac{x^4}{4!}\right)
\left(1+x+\frac{x^2}{2!}\right)
\]
Note that this function is a polynomial of degree $1+4+4+2 = 11$. 
Since we are considering the permutations of 9 of the 11 letters in the word, let's inspect the coefficient of $x^9$.
We notice that is almost matches the solution to our problem. It is
\[
\frac{1}{4!3!2!} + \frac{1}{4!3!2!} + \frac{1}{4!4!1!} + \frac{1}{4!2!2!1!} + \frac{1}{3!3!2!1!} 
\]
\[
+ \frac{1}{4!3!1!1!} + \frac{1}{4!2!2!1!} + \frac{1}{4!3!1!1!} + \frac{1}{4!4!1!}
\]
Thus the answer to our problem can be considered the coefficient not of $x^9$, but of ${x^9}{9!}$. This discussion both motivates the following definition of exponential
generating function and verifies the proposition that follows.

\begin{definition}
The exponential generating function of the sequence $a_0, a_1, a_2, a_3, ...$ is the function
\[
g^{(e)}(x) = a_0 + a_1x + a_2\frac{x^2}{2!} + a_3\frac{x^3}{3!} + \cdots = \sum_{k=0}^\infty a_k \frac{x^k}{k!}
\]
Is the sequence is finite, then the corresponding summation is finite, i.e., the exponential generating function of the sequence
$a_0, a_1, a_2, a_3, ...a_n$ is
\[
g^{(e)}(x) = a_0 + a_1x + a_2\frac{x^2}{2!} + a_3\frac{x^3}{3!} + \cdots  + a_n\frac{x^n}{n!} = \sum_{k=0}^n a_k \frac{x^k}{k!}
\]
\end{definition}

\begin{remark} The name ``exponential" generating function is motivated by the fact that the exponential generating function of the sequence $1, 1, 1, ...$ is
\[
g^{(e)}(x) = 1 + x + \frac{x^2}{2!} + \frac{x^3}{3!} + \cdots = \sum_{k=0}^\infty \frac{x^k}{k!} = e^x
\]
\end{remark}

\begin{proposition}
Let $a_j$ be the number of permutations of $j$ of the objects in the multiset $\{n_1 \cdot c_1, n_2 \cdot c_2, n_3 \cdot c_3, ..., n_k \cdot c_k\}$.
The exponential generating function for the sequence $a_0, a_1, a_2, ..., a_n$ 
is 
\[
g^{(e)}(x) = \prod_{j=0}^k \left(1 + x + \frac{x^2}{2!} + \cdots + \frac{x^{n_j}}{n_j !}\right)
\]
where $n = n_1 + n_2 + n_3 + \cdots + n_k$.
\end{proposition}
\begin{remark}
The repetition numbers $n_i$ in the multiset may be infinite or finite.
\end{remark}

\begin{example}[example 1] 
Find the exponential generating function of the sequence $a_0, a_1, a_2, ..., a_{11}$ where $a_j$ is is the number of 
permutations of $j$ of the elements in the multiset $\{1\cdot M, 4\cdot I, 4\cdot S, 2\cdot P$.\\
According to the proposition with $n_1 = 1, n_2 = 4, n_3 = 4$ and $n_4 = 2$, we have
\[
g^{(e)(x)} = \left(1+x\right)\left(1+x+\frac{x^2}{2!} + \frac{x^3}{3!} + \frac{x^4}{4!}\right)\left(1+x+\frac{x^2}{2!} + \frac{x^3}{3!} + \frac{x^4}{4!}\right)
\left(1+x+\frac{x^2}{2!}\right)
\]
\end{example}

\begin{example}[example 2]
Let $a_j$ be the number of permutations of $j$ of the elements of the multiset $\{1 \cdots c_1, 2 \cdots c_2, \infty \cdots c_3\}$
Find the exponential generating function of the sequence $a_0, a_1, a_2, ...$.\\
According the the proposition, the exponential generating function is
\[
g^{(e)}(x) = (1+x)\left(1 + x + \frac{x^2}{2!}\right)\left(1 + x + \frac{x^2}{2!} + \cdots \right)
\]
\[
= (1+x)\left(1 + x + \frac{x^2}{2!}\right)e^x
\]
\end{example}

\begin{example}[example 3]
Let $a_j$ be the number of permutations of $j$ of the elements of the multiset $\{\infty \cdots c_1, \infty \cdots c_2, \infty \cdots c_3\}$
Find the exponential generating function of the sequence $a_0, a_1, a_2, ...$.\\
According the the proposition, the exponential generating function is
\[
g^{(e)}(x) = \left(1 + x + \frac{x^2}{2!} + \cdots \right)\left(1 + x + \frac{x^2}{2!} + \cdots \right)\left(1 + x + \frac{x^2}{2!} + \cdots \right)
\]
\[
= e^x \cdot e^x \cdot e^x = e^{3x}
\]
\end{example}


\begin{example}[example 4]
Let $a_n$ be the number of ways to color the squares of a $1 \times n$ chess board using the 
colors red, white and blue if the number of squares painted blue must be even. Find the exponential generating function for the sequence $a_0 , a_1, a_2, ...$.\\
This problem is analogous to example 3, with the exception of the condition that the number of blue squares must be even.
Hence, the exponential generating function is
\[
g^{(e)}(x) = \left(1 + x + \frac{x^2}{2!} + \cdots \right)\left(1 + x + \frac{x^2}{2!} + \cdots \right)\left(1 + \frac{x^2}{2!} + + \frac{x^4}{4!} + \cdots \right)
\]
\[
= e^x \cdot e^x \cdot \frac{e^x + e^{-x}}{2} = \frac12 \left(e^{3x} + e^x \right)
\]
Since we know the Maclaurin series for $e^x$, we can find an explicit formula for $a_n$. We have
\[
\frac12 \left(e^{3x} + e^x \right) = \frac12 \sum_{k = 0}^\infty \frac{(3x)^k + x^k}{k!}
\]
and hence $a_n = \dis \frac12 \left(3^n + 1\right)$.
\end{example}


\end{document}





